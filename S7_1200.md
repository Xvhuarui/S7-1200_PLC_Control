<div align='center'>
    <font size="6">
        S7-1200 PLC 电控学习笔记
    </font>
</div>

<center>
    针对“S7-1200(main)”视频课程及个人总结
</center>

## 0.结构基础

<div align=center>
    <img src="./Assets/电控main.png" width=60%>
</div>

（0）main：驱动所有程序块的主要代码，与上位机通讯主要使用TCP/IP协议。

（1）TCP：该程序块为TCP/IP通讯协议。

（2）startup：该程序块为每次上电后接收上一次下电的位置信息。

（3）上电：该程序块为控制IO端口开启或关闭。

（4）伺服电机使能(Servo Motor Enable)：该程序块是指通过特定的信号或电路将伺服电机启用或禁用。

（5）点动控制：主要为二维（x,y）点动控制，共有两种控制方法，即速度控制与位置控制。

（6）PID控制

（7）累加30步：该程序块实现仅累加30步。

（8）限位：该程序块为通过激光传感器传输的信号对机械运动的行程进行限定。

（9）卡尔曼滤波

（10）485通信：该程序块为485通信协议。


## 1.绪论（第一节）
&emsp;&emsp;[西门子股份公司](https://www.siemens.com/cn/zh.html)是一家专注于工业、基础设施、交通和医疗领域的科技公司。从更高效节能的工厂、更具韧性的供应链、更智能的楼宇和电网，到更清洁、更舒适的交通以及先进的医疗系统，西门子致力于让科技有为，为客户创造价值。通过融合现实与数字世界，西门子赋能客户推动产业和市场变革，帮助数十亿计的人们，共创每一天。

&emsp;&emsp;其中，S7-1200与S7-200SMART是现今西门子应用小型的自动化离散控制系统中的主要两款控制器。

<div align=center>
    <img src="./Assets/西门子控制器对比.jpg" width=60%>
</div>

<div align=center>

| 硬件结构 | S7-200SMART | S7-1200 |
| :--------: |:--------: | :--------: |
| 集成通信口 | 以太网接口+RS485 | 以太网接口 |
| 信号板扩展（SB） | 支持 | 支持 |
| 最大扩展模块数 | 6个扩展模块 | 8个信号模块+3个通信模块 |
| 模拟量输入输出 | 不自带 | 自带2路模拟量输入功能 |
| 数字量输入 | 支持源型/漏型接法 | 支持源型/漏型接法 |
| 数字量输出 | 输出高电平信号 | 输出高电平信号 |

</div>

<div align=center>

| 功能与程序结构 | S7-200SMART | S7-1200 |
| :--------: |:--------: | :--------: |
| 通信能力 | 支持S7、open、Modbus通信，DP从站、profinet通信 | 除S7-200SMART所支持的功能外，还可支持远程I/O，DP主站通信等 |
| 高速脉冲输出功能 | 支持3轴高速脉冲输出 | 支持4轴高速脉冲输出 |
| 过程控制功能 | 最多支持8个PID | 最多支持16个PID |
| 运算速度 | 0.15微秒 | 0.08微秒 |
| 数据断电保持方面 | 10KB的保存性储存器 | 10KB的保存性储存器 |
| 程序块 | 主程序、子程序、中断程序 | OB块、FB块、FC块、DB块 |
| 数据类型 | 只有基本的数据类型 | 除基本数据类型之外还有一些复杂的数据类型，参数数据类型等 |

</div>

&emsp;&emsp;TIA 博途软件将所有的自动化软件工具都统一到一个开发环境中，可以在统一开发环境组合几乎所有的西门子可编程控制器、人机界面和驱动装载。

<div align=center>
    <img src="./Assets/TIA博途软件.jpg" width=60%>
</div>

&emsp;&emsp;全部技术可见官方文件[S7-1200 PLC 技术手册 EasyPlus](https://s7-1200plc-easyplus.readthedocs.io/zh-cn/sphinx-doc/index.html)

### 1.1 硬件介绍（第二节）

<div align=center>
    <img src="./Assets/CPU型号说明1.jpg" width=60%>
</div>

&emsp;&emsp;型号CPU xxxxC：紧凑型

&emsp;&emsp;DC/DC/DC：直流24V

&emsp;&emsp;AC/DC/xx：交流220V（RLY主要影响触点的带载能力）

&emsp;&emsp;CPU控制方式有以下分类：

<div align=center>
    <img src="./Assets/CPU控制方式.png" width=60%>
</div>

&emsp;&emsp;工作存储组：相当于计算机的RAM，程序运算在工作存储区。

&emsp;&emsp;装载存储区：相当于计算机的ROM，程序保存在装载存储区。

&emsp;&emsp;保持性存储区：针对断电保持的数据存储。

&emsp;&emsp;远程I/O和扩展的数据走的都是过程映像区。

<div align=center>
    <img src="./Assets/CPU型号说明2.jpg" width=60%>
</div>

&emsp;&emsp;信号模块：数字量输入输出模块、模拟量输入输出模块统称信号模块，在PLC右侧扩展。

<div align=center>
    <img src="./Assets/PLC结构.jpg" width=60%>
</div>

&emsp;&emsp;信号板、通信模块及信号模块扩展均可查询[S7-1200 PLC 产品手册](https://strcsstatic.blob.core.chinacloudapi.cn/downloadcenterproduction/Upload/DocFiles/20096/3401/tb/4080_2023.pdf
)。

<div align=center>
    <img src="./Assets/PLC组装.png" width=50%><img src="./Assets/PLC拆分.png" width=50%>
</div>

&emsp;&emsp;在组装的PLC右上角可以看到S7-1200字样，代表着该PLC为S7-1200类控制器；

&emsp;&emsp;在组装的PLC右侧中间可以看到CPU 1214C DC/DC/DC字样，代表着该CPU型号为紧凑型代码1214，使用直流24V电源供电；

&emsp;&emsp;在拆解后的PLC图中可以看到，中间部位可以扩展信号板，左侧部位已经扩展一块CM 1241通信模块，用于RS232通信。

### 1.2 TIA博图软件的基本使用（第三节）

&emsp;&emsp;本项目教研室使用TIA Portal V15.1软件，打开软件后呈现初始Portal视图（如下图所示），可点击右侧中部“创建”按钮创建新项目。

<div align=center>
    <img src="./Assets/Portal视图.png" width=60%>
</div>

&emsp;&emsp;创建新项目或打开历史项目后，则呈现如下图所示页面，可点击中间下部“打开项目视图”按钮或左下角“项目视图”按钮跳转至项目视图。

<div align=center>
    <img src="./Assets/打开项目.png" width=60%>
</div>

&emsp;&emsp;初始项目如下图所示。

<div align=center>
    <img src="./Assets/新项目视图.png" width=60%>
</div>

&emsp;&emsp;点击“设备”栏“项目名称”下属的“添加新设备”按钮，可根据自身需要选择CPU（如下图所示）。组内裕富一块CPU 1214C DC/DC/DC PLC（214-1AG40-0XB0），可进行调试学习。

<div align=center>
    <img src="./Assets/添加新设备.png" width=60%>
</div>

&emsp;&emsp;选择CPU后，软件会自动生成CPU信息（如下图所示）。从该CPU可以看出，该CPU可在左侧扩展3块通信模块、中间扩展1块信号板、右侧扩展8块信号模块。从右侧“硬件目录”框下可以拉取所需要扩展的模块。组内配套通信模块为CM 1241（241-1AH32-0XB0）以进行RS232通信。

<div align=center>
    <img src="./Assets/添加通信模块.png" width=60%>
</div>

&emsp;&emsp;程序主要可以通过“设备”栏“项目名称”下属的“程序块”进行查看，初始只有一个“main”程序块（如下图所示）。点击“添加新块”按钮，可以添加新的程序块。程序块主要分为四类：OB组织块、FB函数块、FC函数、DB数据块。可用三种语言编写：LAD、FBD、SCL。

<div align=center>
    <img src="./Assets/程序块.png" width=60%>
</div>

### 1.3 S7-1200 PLC 基础知识（第四节）

存储区地址分类：

<div align=center>

| 存储区 | 说明 |
| :--------: |:--------: |
| 过程映像输入（I） | 从扫描周期开始从物理输入复制（按钮） |
| 物理输入（I_:P）| 立即读取CPU的SB和SM的物理输入点 |
| 过程映像输出（Q） | 在扫描周期开始后复制到物理输出 |
| 物理输出（Q_:P）| 立即写入CPU、SB、SM上的物理输出点 |
| 位存储器（M） | 控制盒数据存储器（中间继电器） |
| 临时存储区（L） | 存储块的临时数据，这些数据仅在该块本地范围有效 |
| 数据块（DB） | 数据存储器，同时也是FB的参数存储器 |

</div>

寻址方式：

&emsp;&emsp;8位=1字节&emsp;16位=1字&emsp;32位=双字

&emsp;&emsp;I0.0~I0.7 IB0

&emsp;&emsp;I1.0~I1.7 IB1

&emsp;&emsp;TB0和IB1 IW0

&emsp;&emsp;IW0和IW2 ID0

&emsp;&emsp;FC块里面用形参，FC外用实参

&emsp;&emsp;数据类型用于指定数据元素的大小和格式，在定义变量时需要设置变量的数据类型，在使用指令、函数、函数块时，需要按照操作数要求的数类型使用合适的变量。

&emsp;&emsp;S7-1200中CPU的数据类型分为以下：基本数据类型、复杂数据类型、PLC数据类型（UDT）、VARIANY数据类型、系统数据类型、硬件数据类型

## 2.指令学习（第五节）
### 2.1 基本位逻辑指令（第六节）
### 2.2 定时器与计数器指令（第七节）
### 2.3 比较指令与函数指令（第八节）
### 2.4 转换指令与移动指令（第九节）
### 2.5 移位指令与逻辑运算指令（第十节）
## 3.FB、FC使用说明（第十一节）
## 4.功能应用（第十二节）
### 4.1.PLC通信
#### 4.1.1 MODBUS通信（第十三节）
#### 4.1.2 S7通信（第十四节）
#### 4.1.3 profinet通信（第十五节）
### 4.2.运动控制
#### 4.2.1 运动控制组态（第十六节）
#### 4.2.2 运动控制指令（第十七节）

## 附录：
### （1）网盘链接

通过网盘分享的文件：PLC学习视频

链接: https://pan.baidu.com/s/1n_xGmJcDOixL_-6AZsJNnA

提取码: 6ncj

### （2）基本信息
徐化睿 &emsp; 24B918110

联系方式：15114511742

邮箱：1668385413@qq.com（QQ）




